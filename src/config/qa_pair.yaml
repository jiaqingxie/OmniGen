# QA Pair Generation Configuration
dataset_path: SpectrumWorld/molpuzzle-seed-datasets
generator_type: qa_pair
generator_config:
  prompt_templates:
    single_step:
      template: |
        You are analyzing a molecular spectrum image. Generate a diverse, natural single-step question-answer conversation about this spectrum.

        IMPORTANT CONSTRAINTS - YOU MUST USE THESE EXACT VALUES:
        - Molecular formula: {formula} (DO NOT CHANGE THIS)
        - SMILES notation: {smiles} (DO NOT CHANGE THIS)
        - Spectrum type: {spectrum_type}

        TASK: Generate a natural conversation in the following JSON format:
        [
          {
            "from": "human",
            "value": "Your question here"
          },
          {
            "from": "gpt",
            "value": "Your response here"
          }
        ]

        Vary your approach - use different question styles, response formats, and educational approaches.

        Examples of diverse question styles:
        - "What can you tell me about this {spectrum_type} spectrum?"
        - "Analyze this {spectrum_type} spectrum and identify the compound."
        - "What molecular information can be extracted from this {spectrum_type} spectrum?"
        - "Can you determine the structure from this {spectrum_type} spectrum?"
        - "What does this {spectrum_type} spectrum reveal about the molecule?"

        Examples of diverse response styles:
        - Direct identification: "The compound is {formula} (SMILES: {smiles})."
        - Analytical approach: "Based on the spectral features, this appears to be {formula}..."
        - Educational explanation: "Looking at this {spectrum_type} spectrum, I can identify {formula}..."
        - Step-by-step reasoning: "From the spectral data, I can deduce that this is {formula}..."

        Requirements:
        - MUST use the exact formula and SMILES provided above
        - Create natural, varied conversations (not template-like)
        - Use different question phrasings and response styles
        - Make it educational and engaging
        - Write in clear, scientific English
        - Vary the conversation tone and approach
        - Focus on spectrum analysis and molecular identification
        - Use the EXACT JSON format shown above with "from" and "value" fields

        Please provide only the JSON conversation, no additional text.

    multi_step:
      template: |
        You are analyzing a molecular spectrum image. Generate a diverse, natural multi-step question-answer conversation about this spectrum.

        IMPORTANT CONSTRAINTS - YOU MUST USE THESE EXACT VALUES:
        - Molecular formula: {formula} (DO NOT CHANGE THIS)
        - SMILES notation: {smiles} (DO NOT CHANGE THIS)
        - Spectrum type: {spectrum_type}

        TASK: Generate a natural multi-step conversation in the following JSON format:
        [
          {
            "from": "human",
            "value": "First question here"
          },
          {
            "from": "gpt",
            "value": "First response here"
          },
          {
            "from": "human",
            "value": "Follow-up question here"
          },
          {
            "from": "gpt",
            "value": "Follow-up response here"
          }
        ]

        Create varied, educational exchanges that build upon each other.

        Examples of diverse conversation flows:
        
        Flow 1 - Identification → Analysis:
        - Q: "What compound is this?" → A: "This is {formula}..."
        - Q: "What can you tell me about the spectral features?" → A: "The spectrum shows..."

        Flow 2 - Analysis → Confirmation:
        - Q: "Analyze this {spectrum_type} spectrum." → A: "Looking at the peaks, this appears to be {formula}..."
        - Q: "How confident are you in that identification?" → A: "Very confident because..."

        Flow 3 - Educational → Deep Dive:
        - Q: "Can you help me understand this spectrum?" → A: "Of course! This {spectrum_type} spectrum shows {formula}..."
        - Q: "What specific features should I look for?" → A: "The key features are..."

        Flow 4 - Problem-solving → Explanation:
        - Q: "I'm having trouble interpreting this spectrum." → A: "Let me help you identify this as {formula}..."
        - Q: "What's the reasoning behind that conclusion?" → A: "The evidence comes from..."

        Requirements:
        - MUST use the exact formula and SMILES provided above
        - Create natural, varied multi-step conversations
        - Use different question styles and response approaches
        - Build educational progression between exchanges
        - Vary conversation tone and teaching style
        - Make it engaging and informative
        - Focus on spectrum analysis and molecular identification
        - Ensure logical flow between questions and answers
        - Use the EXACT JSON format shown above with "from" and "value" fields

        Please provide only the JSON conversation, no additional text.

  qa_types: ["single_step", "multi_step"]
  
  # Conversation settings
  min_conversation_length: 2
  max_conversation_length: 6
  
  # Image output settings
  image_output_dir: "output/qa_spectrum_images"
  
  # Text generation settings
  max_out_len: 2000

model_type: internvl
model_config:
  api_key: ${INTERNVL_API_KEY}
  base_url: ${INTERNVL_BASE_URL}
  model_name: ${INTERNVL_MODEL_NAME}
  max_seq_len: 2048

num_samples: 20
output_path: output/qa_pairs.json
verbose: true
max_retries: 3
